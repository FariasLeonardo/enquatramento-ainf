<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Suspenso</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 40px;
            line-height: 1.6;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }
        h2 {
            color: #333;
            border-bottom: 2px solid #0066cc;
            padding-bottom: 5px;
            margin-bottom: 20px;
        }
        .bloco {
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 30px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            position: relative;
        }
        p {
            margin: 10px 0;
            text-align: justify;
        }
        .form-container {
            background-color: #fff;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        label {
            display: block;
            margin: 10px 0 5px;
            font-weight: bold;
        }
        input[type="text"], select {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }
        button {
            background-color: #0066cc;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-right: 10px;
        }
        button:hover {
            background-color: #004d99;
        }
        #notas-container {
            margin-top: 20px;
        }
        .nota-section {
            border: 1px dashed #ccc;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 4px;
            position: relative;
        }
        .remove-btn {
            background-color: #cc0000;
            padding: 5px 10px;
            position: absolute;
            top: 10px;
            right: 10px;
        }
        .remove-btn:hover {
            background-color: #990000;
        }
        #referencia-nf {
            font-weight: bold;
            color: #0066cc;
            text-align: justify;
        }
        #infrigencia_texto {
            text-align: justify;
        }
        .header {
            margin-bottom: 20px;
        }
        .footer {
            text-align: center;
            margin-top: 20px;
        }
        .copy-btn {
            background-color: #4CAF50;
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            position: absolute;
            top: 10px;
            right: 10px;
        }
        .copy-btn:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
    <div class="header">
        <button onclick="voltarPaginaAnterior()">Voltar</button>
    </div>

    <div class="form-container">
        <h2>Insira as Informações</h2>
        <div id="notas-container">
            <div class="nota-section" id="nota-1">
                <label for="nf-1">Número da Nota Fiscal:</label>
                <input type="text" id="nf-1" placeholder="Digite o número da NF">
                <button class="remove-btn" onclick="removerNota(1)" style="display: none;">Remover</button>
            </div>
        </div>
        <button onclick="adicionarNota()">Adicionar Nova Nota Fiscal</button>

        <div>
            <label for="item_art150">Item do Artigo 150 (Infrigência):</label>
            <select id="item_art150">
                <option value="">Selecione...</option>
                <option value="I">I - Durante o período de paralisação temporária</option>
                <option value="II">II - Durante o lapso de tempo entre a data em que o contribuinte requerer a baixa</option>
                <option value="III">III - Quando o estabelecimento não for localizado no endereço constante na ficha cadastral</option>
                <option value="IV">IV - Quando, no prazo de 30 (trinta) dias da concessão da inscrição, não possuir documentos fiscais válidos</option>
                <option value="V">V - Durante o lapso de tempo entre a data em que incorrer nas hipóteses previstas no art. 154</option>
                <option value="VI">VI - Quando o contribuinte, participante do Regime Tributário Especial do ICMS</option>
                <option value="VII">VII - Quando o prazo final de data limite para emissão do documento fiscal estiver vencido</option>
                <option value="VIII">VIII - Quando inadimplente com a entrega da declaração anual de informações</option>
                <option value="IX">IX - Quando inadimplente com o preenchimento e entrega do Programa Gerador do Documento de Arrecadação</option>
                <option value="X">X - Quando emissor regular de documentos eletrônicos, deixar de emiti-los por um período igual ou superior a três meses</option>
                <option value="XI">XI - Quando esteja por mais de 30 (trinta) dias na situação de ativo não regular</option>
                <option value="XII">XII - A partir da data do registro de desenquadramento no Portal do Simples Nacional</option>
                <option value="XIII">XIII - Quando constatado que o contribuinte utilizou de atos e negócios de interpostas pessoas</option>
                <option value="XIV">XIV - Quando constatado que o contribuinte responsável por empreendimentos que extraiam, coletem</option>
                <option value="XV">XV - Quando identificadas, mediante monitoramento fiscal, irregularidades</option>
            </select>
        </div>

        <button onclick="atualizarTexto()">Gerar Texto</button>
    </div>

    <div class="bloco">
        <h2>Ocorrência <button class="copy-btn" onclick="copiarTexto('ocorrencia')">Copiar</button></h2>
        <p id="referencia-nf">Referente à nota fiscal: [VALOR_DANFE]</p>
        <p id="texto_ocorrencia">[TEXTO_OCORRÊNCIA]</p>
    </div>

    <div class="bloco">
        <h2>Infrigência <button class="copy-btn" onclick="copiarTexto('infrigencia')">Copiar</button></h2>
        <p id="infrigencia_texto">[INFRIGÊNCIA]</p>
    </div>

    <div class="footer">
        <button onclick="limpar()">Limpar</button>
    </div>

    <script>
        let notaCount = 1;

        function adicionarNota() {
            notaCount++;
            const container = document.getElementById("notas-container");
            const newNota = document.createElement('div');
            newNota.className = "nota-section";
            newNota.id = `nota-${notaCount}`;
            newNota.innerHTML = `
                <label for="nf-${notaCount}">Número da Nota Fiscal:</label>
                <input type="text" id="nf-${notaCount}" placeholder="Digite o número da NF">
                <button class="remove-btn" onclick="removerNota(${notaCount})">Remover</button>
            `;
            container.appendChild(newNota);
            atualizarBotoesRemover('.nota-section');
        }

        function removerNota(id) {
            const nota = document.getElementById(`nota-${id}`);
            if (nota) nota.remove();
            atualizarBotoesRemover('.nota-section');
        }

        function atualizarBotoesRemover(seletor) {
            const notas = document.querySelectorAll(seletor);
            notas.forEach((nota) => {
                const btn = nota.querySelector(".remove-btn");
                if (btn) {
                    btn.style.display = notas.length > 1 ? "inline-block" : "none";
                }
            });
        }

        function limpar() {
            notaCount = 1;
            
            document.getElementById("notas-container").innerHTML = `
                <div class="nota-section" id="nota-1">
                    <label for="nf-1">Número da Nota Fiscal:</label>
                    <input type="text" id="nf-1" placeholder="Digite o número da NF">
                    <button class="remove-btn" onclick="removerNota(1)" style="display: none;">Remover</button>
                </div>
            `;
            
            document.getElementById("referencia-nf").innerHTML = "Referente à nota fiscal: [VALOR_DANFE]";
            document.getElementById("texto_ocorrencia").innerHTML = "[TEXTO_OCORRÊNCIA]";
            document.getElementById("infrigencia_texto").innerHTML = "[INFRIGÊNCIA]";
            document.getElementById("item_art150").value = "";
            
            setTimeout(() => {
                const firstNfInput = document.getElementById('nf-1');
                if (firstNfInput) {
                    firstNfInput.focus();
                }
            }, 10);
        }

        function voltarPaginaAnterior() {
            window.location.href = "index.html";
        }
        
        function copiarTexto(secao) {
            let textoParaCopiar = "";
            if (secao === 'ocorrencia') {
                textoParaCopiar = document.getElementById('referencia-nf').innerText + "\n" +
                                  document.getElementById('texto_ocorrencia').innerText;
            } else if (secao === 'infrigencia') {
                textoParaCopiar = document.getElementById('infrigencia_texto').innerText;
            }
            
            if (textoParaCopiar) {
                const tempTextArea = document.createElement('textarea');
                tempTextArea.value = textoParaCopiar;
                document.body.appendChild(tempTextArea);
                tempTextArea.select();
                document.execCommand('copy');
                document.body.removeChild(tempTextArea);
                alert("Texto copiado para a área de transferência!");
            }
        }

        function atualizarTexto() {
            let notasFiscais = [];
            const notas = document.querySelectorAll(".nota-section");

            notas.forEach((nota) => {
                const nfInput = nota.querySelector("input[id^='nf-']");
                if (nfInput && nfInput.value) {
                    notasFiscais.push(nfInput.value);
                }
            });
            
            const referenciaNf = document.getElementById("referencia-nf");
            referenciaNf.innerHTML = notasFiscais.length > 1
                ? `Referente às notas fiscais: ${notasFiscais.join(', ')}`
                : `Referente à nota fiscal: ${notasFiscais[0] || "NÃO INFORMADO"}`;

            const textoOcorrencia = document.getElementById("texto_ocorrencia");
            const textoBaseOcorrencia = `Durante operação de fiscalização no posto fiscal de Itinga, o condutor apresentou a${notasFiscais.length > 1 ? 's' : ''} DANFE listada${notasFiscais.length > 1 ? 's' : ''} acima pertencente a destinatário que se encontra na situação cadastral de suspenso. Pelos motivos anteriormente explanados, foi lavrado este presente termo cobrando antecipadamente o imposto devido, conforme legislação estadual e consulta cadastral anexa.`;
            textoOcorrencia.innerHTML = textoBaseOcorrencia;

            const itemArt150 = document.getElementById("item_art150").value;
            const infrigenciaTexto = document.getElementById("infrigencia_texto");
            let textoInfrigencia = "[INFRIGÊNCIA NÃO ESPECIFICADA]";

            if (itemArt150) {
                const primeiraParte = `
                    - C.C. LEI 5.530/89, ART. 1º, I, ART. 2º, §3º, ART. 8º E ART. 78, I, “J”;<br>
                    - DECRETO 4.676/01 (RICMS), ART. 108, § 7º, ART.115, I, ART. 148, II, ART. 150, ${itemArt150}, ART. 151, ART. 151-A, ART. 167-C, ART. 728, VII, “B”;<br>
                    - LEI 6.182/98, ART. 2O, ART. 60 (CAPUT), §1º, “IV”, § 2° E ART. 61;<br>
                    - IN SEFA 18/2001;<br><br>`;

                const itensArt150 = {
                    "I": "I - Durante o período de paralisação temporária;",
                    "II": "II - Durante o lapso de tempo entre a data em que o contribuinte requerer a baixa da inscrição à repartição fiscal e a baixa definitiva da inscrição;",
                    "III": "III - Quando o estabelecimento não for localizado no endereço constante na ficha cadastral, desde a data em que for verificada a ocorrência até a data da inaptidão da inscrição estadual;",
                    "IV": "IV - Quando, no prazo de 30 (trinta) dias da concessão da inscrição, não possuir documentos fiscais válidos, salvo se dispensado de emissão destes;",
                    "V": "V - Durante o lapso de tempo entre a data em que incorrer nas hipóteses previstas no art. 154 e a publicação no Diário Oficial do Estado de sua declaração de inaptidão;",
                    "VI": "VI - Quando o contribuinte, participante do Regime Tributário Especial do ICMS na condição de 'Pessoa Natural - Comércio/Indústria' ou 'Pessoa Natural - Transportador Alternativo de Passageiros' for desenquadrado de ofício pelo fisco;",
                    "VII": "VII - Quando o prazo final de data limite para emissão do documento fiscal estiver vencido, sem que o contribuinte tenha solicitado nova AIDF, salvo se dispensado de emissão dos mesmos;",
                    "VIII": "VIII - Quando inadimplente com a entrega da declaração anual de informações estabelecida para os contribuintes optantes pelo Regime Especial Unificado de Arrecadação de Tributos e Contribuições devidos pelas Microempresas e Empresas de Pequeno Porte - Simples Nacional, instituído pela Lei Complementar nº 123, de 14 de dezembro de 2006, a que estiver obrigado;",
                    "IX": "IX - Quando inadimplente com o preenchimento e entrega do Programa Gerador do Documento de Arrecadação do Simples a que estão obrigados os contribuintes optantes do Regime do Simples Nacional;",
                    "X": "X - Quando emissor regular de documentos eletrônicos, deixar de emiti-los por um período igual ou superior a três meses;",
                    "XI": "XI - Quando esteja por mais de 30 (trinta) dias na situação de ativo não regular, deixar de entregar declaração a que esteja obrigado;",
                    "XII": "XII - A partir da data do registro de desenquadramento no Portal do Simples Nacional, quando o contribuinte, na condição de microempreendedor individual, for desenquadrado em decorrência de movimentação financeira acima do limite permitido pela legislação pertinente, enquanto não possuir os documentos e livros fiscais obrigatórios ao seu funcionamento na condição de microempresa;",
                    "XIII": "XIII - Quando constatado que o contribuinte utilizou de atos e negócios de interpostas pessoas, falsificação de documentos, simulação de operações ou prestações;",
                    "XIV": "XIV - Quando constatado que o contribuinte responsável por empreendimentos que extraiam, coletem, beneficiem, transformem, industrializem e armazenem produtos, subprodutos ou matéria prima de origem nativa florestal, emitiu Nota Fiscal referente a produtos e subprodutos de origem florestal sem estar registrado no Cadastro de Exportadores e Consumidores de Produtos Florestais do Estado do Pará -CEPROF - PA, quando obrigatório;",
                    "XV": "XV - Quando identificadas, mediante monitoramento fiscal, irregularidades, conforme definido em ato do Secretário de Estado da Fazenda;"
                };

                const segundaParte = `
                    Art. 150. O contribuinte terá sua inscrição no Cadastro de Contribuintes do ICMS suspensa, nas seguintes hipóteses:<br>
                    ${itensArt150[itemArt150]}`;

                textoInfrigencia = primeiraParte + segundaParte;
            }

            infrigenciaTexto.innerHTML = textoInfrigencia;
        }
    </script>
</body>
</html>